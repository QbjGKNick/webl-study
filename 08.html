<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <canvas id="canvas" width="1000" height="1000"></canvas>
  <script type="module">
    import { $$ } from './utils/common.js'

    window.onload = function () {
      const cnv = $$("canvas")
      const cxt = cnv.getContext('2d')


      /*
      const image = new Image()
      image.src = "images/lufei.jpg"
      image.onload = function () {
        cxt.drawImage(image, 10, 10)
        const imageData = cxt.getImageData(10, 10, 500, 500)
        const data = imageData.data
  
        // const a = 50
        // 遍历每个像素
        for (var i = 0; i < data.length; i += 4) {
          // data[i + 0] = 255 - data[i + 0]
          // data[i + 1] = 255 - data[i + 1]
          // data[i + 2] = 255 - data[i + 2]
  
          // const average = (data[i + 0] * 0.3 + data[i + 1] * 0.5 + data[i + 2] * 0.2) / 3
          // data[i + 0] = average
          // data[i + 1] = average
          // data[i + 2] = average
  
          // data[i + 0] -= a
          // data[i + 1] -= a
          // data[i + 2] -= a
  
          // const r = data[i + 0]
          // const g = data[i + 1]
          // const b = data[i + 2]
  
          // 复古
          // data[i + 0] = r * 0.39 + g * 0.76 + b * 0.18
          // data[i + 1] = r * 0.35 + g * 0.68 + b * 0.16
          // data[i + 2] = r * 0.27 + g * 0.53 + b * 0.13
  
          // // 红色蒙版
          // data[i + 0] = average
          // data[i + 1] = 0
          // data[i + 2] = 0
  
          // 透明处理
          data[i + 3] = data[i + 3] * 0.3
  
        }
        cxt.putImageData(imageData, 540, 10)
        
      }
      */

      const imageData = cxt.createImageData(100, 100)
      const data = imageData.data
      for (var i = 0; i < 100 * 100 * 4; i += 4) {
        data[i + 0] = 0
        data[i + 1] = 0
        data[i + 2] = 255
        data[i + 3] = 255
      }
      cxt.putImageData(imageData, 20, 20)


    }

  </script>
</body>

</html>